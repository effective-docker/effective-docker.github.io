batch
    |query('SELECT mean(usage_idle) FROM "telegraf"."default"."cpu"')
        .period(5m)
        .every(5m)
        .groupBy('host')
    |alert()
        .warn(lambda: "mean" < 70)
        .crit(lambda: "mean" < 50)
         .message('high cpu load - {{ .Level}} - Idle: {{ index .Fields "mean" }}%. Host: {{index .Tags "host"}}')
        .email()
        .to('martin@effectivetrainings.de')
